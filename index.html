<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä</title>
<style>
  body { font-family: sans-serif; text-align:center; margin:8px; background:linear-gradient(135deg,#f9f9f9,#e0f7fa); }
  h1{font-size:24px;margin-bottom:10px;color:#333;}
  .task{font-size:28px;margin:10px 0;font-weight:bold;color:#1565c0;}
  button, select{font-size:18px;padding:10px;margin:8px;border-radius:12px;border:none;color:#fff;background:linear-gradient(45deg,#4CAF50,#81C784);width:90%;max-width:300px;}
  .answer-btn{width:80px;height:80px;border-radius:50%;font-size:22px;font-weight:bold;margin:10px;
    box-shadow:0 4px 8px rgba(0,0,0,.2);transition:transform .08s}
  .answer-btn:active{transform:scale(.92)}
  #answer-buttons{display:flex;justify-content:center;gap:20px;flex-wrap:wrap;margin-top:10px}
  .result{font-size:20px;margin-top:10px;min-height:30px}
  .scoreboard{font-size:16px;padding:10px;background:#fff;display:inline-block;border-radius:10px;margin-top:15px}
  .timer{font-size:22px;margin-top:10px;color:#d32f2f;font-weight:bold}
</style>
</head>
<body>

<h1>üé≤ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä üé≤</h1>

<label>–£—Ä–æ–≤–µ–Ω—å:</label><br>
<select id="level">
  <option value="10">–õ—ë–≥–∫–∏–π (–¥–æ 10)</option>
  <option value="20" selected>–°—Ä–µ–¥–Ω–∏–π (–¥–æ 20)</option>
  <option value="100">–°–ª–æ–∂–Ω—ã–π (–¥–æ 100)</option>
</select>
<br>
<label>–û–ø–µ—Ä–∞—Ü–∏–∏:</label><br>
<select id="operations">
  <option value="basic" selected>+ –∏ ‚àí</option>
  <option value="all">–í—Å–µ (+ ‚àí √ó √∑)</option>
</select>

<div class="task" id="task">–ù–∞–∂–º–∏ "–°—Ç–∞—Ä—Ç"</div>

<div id="answer-buttons">
  <button class="answer-btn" id="btn1" disabled></button>
  <button class="answer-btn" id="btn2" disabled></button>
  <button class="answer-btn" id="btn3" disabled></button>
</div>

<button id="startBtn">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>

<div class="result" id="result"></div>

<div class="scoreboard">
  <span>‚úÖ: <b id="correctCount">0</b></span>
  <span style="margin-left:12px">‚ùå: <b id="wrongCount">0</b></span>
</div>

<div class="timer" id="timer">‚è≥ 60</div>

<script>
let correctAnswer = 0;
let correct = 0, wrong = 0;
let timeLeft = 60;
let timer;
let gameActive = false;

const task = document.getElementById("task");
const result = document.getElementById("result");
const timerBox = document.getElementById("timer");
const btns = [
  document.getElementById("btn1"),
  document.getElementById("btn2"),
  document.getElementById("btn3")
];

function vibrate(p) {
  if (navigator.vibrate) navigator.vibrate(p);
}

function startGame() {
  gameActive = true;
  correct = 0; wrong = 0; timeLeft = 60;
  document.getElementById("correctCount").innerText = correct;
  document.getElementById("wrongCount").innerText = wrong;
  result.innerText = "";
  newTask();

  timer = setInterval(() => {
    timeLeft--;
    timerBox.innerText = "‚è≥ " + timeLeft;
    if (timeLeft <= 0) endGame();
  }, 1000);
}

function endGame() {
  clearInterval(timer);
  gameActive = false;
  task.innerText = "‚èπ –í—Ä–µ–º—è –≤—ã—à–ª–æ!";
  result.innerText = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${correct} / ${wrong}`;
  btns.forEach(b => b.disabled = true);
}

function newTask() {
  const maxNumber = parseInt(document.getElementById("level").value);
  const mode = document.getElementById("operations").value;

  let a = Math.floor(Math.random()*maxNumber)+1;
  let b = Math.floor(Math.random()*maxNumber)+1;
  let opList = mode === "basic" ? ["+","-"] : ["+","-","√ó","√∑"];
  let op = opList[Math.floor(Math.random()*opList.length)];

  if (op === "-") { if (b>a) [a,b]=[b,a]; correctAnswer = a-b; }
  if (op === "+") correctAnswer = a+b;
  if (op === "√ó") correctAnswer = a*b;
  if (op === "√∑") {
    b = Math.floor(Math.random()*maxNumber)+1;
    correctAnswer = Math.floor(Math.random()*maxNumber)+1;
    a = b * correctAnswer;
  }

  task.innerText = `${a} ${op} ${b} = ?`;

  // –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞
  const options = new Set([correctAnswer]);
  while (options.size < 3) {
    let d = Math.floor(Math.random()*7)-3;
    if (d !== 0) options.add(correctAnswer + d);
  }

  const arr = Array.from(options).sort(() => Math.random()-0.5);

  btns.forEach((b, i) => {
    b.innerText = arr[i];
    b.disabled = false;
  });
}

btns.forEach(b => {
  b.addEventListener("click", () => {
    if (!gameActive) return;

    let val = parseInt(b.innerText);
    btns.forEach(x => x.disabled = true);

    if (val === correctAnswer) {
      correct++;
      document.getElementById("correctCount").innerText = correct;
      result.innerText = "‚úîÔ∏è –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
      result.style.color = "green";
      vibrate(50);
    } else {
      wrong++;
      document.getElementById("wrongCount").innerText = wrong;
      result.innerText = "‚ùå –ù–µ–≤–µ—Ä–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω–æ: " + correctAnswer;
      result.style.color = "red";
      vibrate([100,40,100]);
    }

    setTimeout(newTask, 600);
  });
});

document.getElementById("startBtn").addEventListener("click", startGame);
</script>

</body>
</html>
